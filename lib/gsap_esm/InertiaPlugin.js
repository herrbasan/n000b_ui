/*!
 * InertiaPlugin 3.2.6
 * https://greensock.com
 *
 * @license Copyright 2008-2020, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
import{VelocityTracker}from"./utils/VelocityTracker.js";var gsap,_coreInitted,_parseEase,_toArray,_power3,_config,_getUnit,PropTween,_getCache,_checkPointRatio,_clamp,_getTracker=VelocityTracker.getByTarget,_getGSAP=function(){return gsap||"undefined"!=typeof window&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap},_isString=function(e){return"string"==typeof e},_isNumber=function(e){return"number"==typeof e},_isObject=function(e){return"object"==typeof e},_isFunction=function(e){return"function"==typeof e},_bonusValidated=1,_isArray=Array.isArray,_emptyFunc=function(e){return e},_bigNum=1e10,_tinyNum=1/_bigNum,_checkPoint=.05,_round=function(e){return Math.round(1e4*e)/1e4},_extend=function(e,t,i){for(var r in t)r in e||r===i||(e[r]=t[r]);return e},_getClosest=function(e,t,i,r,n){var a,o,s,c,u=t.length,_=0,g=_bigNum;if(_isObject(e)){for(;u--;){for(s in a=t[u],o=0,e)o+=(c=a[s]-e[s])*c;o<g&&(_=u,g=o)}if((n||_bigNum)<_bigNum&&n<Math.sqrt(g))return e}else for(;u--;)(o=(a=t[u])-e)<0&&(o=-o),o<g&&a>=r&&a<=i&&(_=u,g=o);return t[_]},_parseEnd=function(e,t,i,r,n,a){if("auto"===e.end)return e;var o,s,c=e.end;if(i=isNaN(i)?_bigNum:i,r=isNaN(r)?-_bigNum:r,_isObject(t)){if(o=t.calculated?t:(_isFunction(c)?c(t):_getClosest(t,c,i,r,a))||t,!t.calculated){for(s in o)t[s]=o[s];t.calculated=!0}o=o[n]}else o=_isFunction(c)?c(t):_isArray(c)?_getClosest(t,c,i,r,a):parseFloat(c);return o>i?o=i:o<r&&(o=r),{max:o,min:o,unitFactor:e.unitFactor}},_getNumOrDefault=function(e,t,i){return isNaN(e[t])?i:+e[t]},_calculateChange=function(e,t){return t*_checkPoint*e/_checkPointRatio},_calculateDuration=function(e,t,i){return Math.abs((t-e)*_checkPointRatio/i/_checkPoint)},_reservedProps={resistance:1,checkpoint:1,preventOvershoot:1,linkedProps:1,radius:1,duration:1},_processLinkedProps=function(e,t,i,r){if(t.linkedProps){var n,a,o,s,c,u,_=t.linkedProps.split(","),g={};for(n=0;n<_.length;n++)(o=t[a=_[n]])&&(s=_isNumber(o.velocity)?o.velocity:(c=c||_getTracker(e))&&c.isTracking(a)?c.get(a):0,u=Math.abs(s/_getNumOrDefault(o,"resistance",r)),g[a]=parseFloat(i(e,a))+_calculateChange(s,u));return g}},_calculateTweenDuration=function(e,t,i,r,n,a){if(void 0===i&&(i=10),void 0===r&&(r=.2),void 0===n&&(n=1),void 0===a&&(a=0),_isString(e)&&(e=_toArray(e)[0]),!e)return 0;var o,s,c,u,_,g,p,l,m,f,d=0,h=_bigNum,v=t.inertia||t,y=_getCache(e).get,k=_getNumOrDefault(v,"resistance",_config.resistance);for(o in f=_processLinkedProps(e,v,y,k),v)_reservedProps[o]||(s=v[o],_isObject(s)||((l=l||_getTracker(e))&&l.isTracking(o)?s=_isNumber(s)?{velocity:s}:{velocity:l.get(o)}:(u=+s||0,c=Math.abs(u/k))),_isObject(s)&&(u=_isNumber(s.velocity)?s.velocity:(l=l||_getTracker(e))&&l.isTracking(o)?l.get(o):0,c=_clamp(r,i,Math.abs(u/_getNumOrDefault(s,"resistance",k))),g=(_=parseFloat(y(e,o))||0)+_calculateChange(u,c),"end"in s&&(s=_parseEnd(s,f&&o in f?f:g,s.max,s.min,o,v.radius),a&&(v[o]=_extend(s,v[o],"end"))),"max"in s&&g>+s.max+_tinyNum?(m=s.unitFactor||_config.unitFactors[o]||1,(p=_>s.max&&s.min!==s.max||u*m>-15&&u*m<45?r+.1*(i-r):_calculateDuration(_,s.max,u))+n<h&&(h=p+n)):"min"in s&&g<+s.min-_tinyNum&&(m=s.unitFactor||_config.unitFactors[o]||1,(p=_<s.min&&s.min!==s.max||u*m>-45&&u*m<15?r+.1*(i-r):_calculateDuration(_,s.min,u))+n<h&&(h=p+n)),p>d&&(d=p)),c>d&&(d=c));return d>h&&(d=h),d>i?i:d<r?r:d},_initCore=function(){(gsap=_getGSAP())&&(_parseEase=gsap.parseEase,_toArray=gsap.utils.toArray,_getUnit=gsap.utils.getUnit,_getCache=gsap.core.getCache,_clamp=gsap.utils.clamp,_power3=_parseEase("power3"),_checkPointRatio=_power3(.05),PropTween=gsap.core.PropTween,gsap.config({resistance:100,unitFactors:{time:1e3,totalTime:1e3}}),_config=gsap.config(),gsap.registerPlugin(VelocityTracker),_coreInitted=1)};export var InertiaPlugin={version:"3.2.6",name:"inertia",register:function(e){gsap=e,_initCore()},init:function(e,t,i,r,n){_coreInitted||_initCore();var a=_getTracker(e);if("auto"===t){if(!a)return;t=a.getAll()}this.target=e,this.tween=i;var o,s,c,u,_,g,p,l,m,f=e._gsap,d=f.get,h=t.duration,v=_isObject(h),y=t.preventOvershoot||v&&0===h.overshoot,k=_getNumOrDefault(t,"resistance",_config.resistance),b=_isNumber(h)?h:_calculateTweenDuration(e,t,v&&h.max||10,v&&h.min||.2,v&&"overshoot"in h?+h.overshoot:y?0:1);for(o in m=_processLinkedProps(e,t,d,k),t)_reservedProps[o]||(s=t[o],_isFunction(s)&&(s=s(r,e,n)),_isNumber(s)?_=s:_isObject(s)&&!isNaN(s.velocity)?_=+s.velocity:a&&a.isTracking(o)&&(_=a.get(o)),g=_calculateChange(_,b),l=0,c=d(e,o),u=_getUnit(c),c=parseFloat(c),_isObject(s)&&(p=c+g,"end"in s&&(s=_parseEnd(s,m&&o in m?m:p,s.max,s.min,o,t.radius)),"max"in s&&+s.max<p?y||s.preventOvershoot?g=s.max-c:l=s.max-c-g:"min"in s&&+s.min>p&&(y||s.preventOvershoot?g=s.min-c:l=s.min-c-g)),this._props.push(o),this._pt=new PropTween(this._pt,e,o,c,0,_emptyFunc,0,f.set(e,o,this)),this._pt.u=u||0,this._pt.c1=g,this._pt.c2=l);return i.duration(b),_bonusValidated},render:function(e,t){var i=t._pt;for(e=_power3(t.tween._time/t.tween._dur);i;)i.set(i.t,i.p,_round(i.s+i.c1*e+i.c2*e*e)+i.u,i.d,e),i=i._next}};"track,untrack,isTracking,getVelocity,getByTarget".split(",").forEach((function(e){return InertiaPlugin[e]=VelocityTracker[e]})),_getGSAP()&&gsap.registerPlugin(InertiaPlugin);export{InertiaPlugin as default,VelocityTracker};